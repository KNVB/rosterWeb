<!DOCTYPE html>
<html>
	<head>
		<meta charset="UTF-8">
		<title>Copy event to clipboard</title>
		<style>
			/*::selection {
			  background: none; /* WebKit/Blink Browsers */
			}
			::-moz-selection {
			  background: none; /* Gecko Browsers */
			}*/		
		</style>
		<script src="https://code.jquery.com/jquery-3.3.1.js"></script>
		<script>
			$( document ).ready(function() {
				$("td").on("paste",function(event){
					console.log(this.textContent);
					console.log("cell paste event");
					var self = this;
					setTimeout(function() {
						self.blur();
					}, 0);
				});
				$("body").keydown(function(event){
					switch (event.which)
					{
						case 86://v
								if (event.ctrlKey)	
								{
									pasteDemo();
								}
					}			
				});
			});
			function pasteDemo()
			{
				console.log("Body Paste Event");
				var inputBox=document.createElement("input");
				var cell1=document.getElementById("c11");
				var range=document.createRange();
				var selection=window.getSelection();
				$("body").append(inputBox);
				inputBox.value="QQ";
				inputBox.select();
				
				console.log("Copy Result="+document.execCommand("copy"));
				cell1.focus();
				$(inputBox).remove();
				console.log("Paste Result="+document.execCommand("paste"));
				
			}
		</script>	
	</head>
	<body>
		<table border="1" id="destTable" width="500px">
			<tr>
				<td id="c11" contenteditable="true" style="width:96px"></td>
				<td id="c12" contenteditable="true"></td>
				<td id="c13" contenteditable="true"></td>
			</tr>
			<tr>
				<td id="c21" contenteditable="true"></td>
				<td id="c22" contenteditable="true"></td>
				<td id="c23" contenteditable="true"></td>
			</tr>
			<tr>
				<td id="c31" contenteditable="true"></td>
				<td id="c32" contenteditable="true"></td>
				<td id="c33" contenteditable="true"></td>
			</tr>
		</table>
		<!--
		Even I put the element outside the above, the paste function still does not work
		<div id="c11" contenteditable="true"></div>
		<textarea id="c11"></textarea>
		-->
	</body>
</html>